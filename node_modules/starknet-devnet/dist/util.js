"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.sleep = sleep;
exports.isFreePort = isFreePort;
const net_1 = __importDefault(require("net"));
async function sleep(millis) {
    await new Promise((resolve, _) => setTimeout(resolve, millis));
}
function isFreePort(port) {
    return new Promise((accept, reject) => {
        const sock = net_1.default.createConnection(port);
        sock.once("connect", () => {
            sock.end();
            accept(false);
        });
        sock.once("error", (e) => {
            sock.destroy();
            if (e.code === "ECONNREFUSED") {
                accept(true);
            }
            else {
                reject(e);
            }
        });
    });
}
